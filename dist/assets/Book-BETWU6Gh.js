import{x as O,h as Y,z as h,k as K,a as Q,c as U,r as o,j as e,A as D,u as G,S as H}from"./index-CxhnL_yD.js";import{a as J}from"./apiBooks-BgPxOzWy.js";import{E as V}from"./ErrorFallback-BvHCA0Dg.js";import{b as W}from"./index-CSx6wYZJ.js";import{a as X}from"./index-RhR9qCDk.js";import{u as Z,S as ee}from"./SpinnerMini-TSTRqYFy.js";import{i as se,a as te}from"./useCartLists-BCz1lc0l.js";import"./index-BXsKJbct.js";import"./iconBase-fCoKCrix.js";function ae(){const{id:s}=O(),{isLoading:t,data:a,error:r}=Y({queryKey:["book",s],queryFn:()=>J(s)});return{isLoading:t,book:a,error:r}}function re(){const{mutate:s,isPending:t,error:a}=Z({mutationFn:se,onSuccess:()=>{h.success("Your book is successfully added to the cart.”")},onError:()=>{h.error("Your book was not added to the cart.")}});return{insertToCart:s,isLoading:t,error:a}}function oe({book:s}){const t=K(),{book_name:a,author:r,book_type:p,copies_sold:w,description:B,first_published:T,image_back:b,image_front:c,latest_edition:_,price:i,theme:L,type:n}=s,g=Q(),{insertToCart:A,isLoading:E}=re(),{cartList:F}=te(),{user:j}=U(),$=1,d=s?.id,I=j?.id;function M(){F?.filter(f=>f.user_id===j.id)?.find(f=>f.books.id===d)?.books?.id!==d?A({quantity:$,book_id:d,user_id:I,price:i},{onSuccess:()=>{g(D(!0)),t("/books")}}):(h.error("This book was already added to the cart."),g(D(!0)))}const[m,y]=o.useState(!0),[x,k]=o.useState(!1),[P,N]=o.useState(null),S=o.useRef(null),v=o.useRef(null);function z(){y(!0),k(!1)}function R(){k(!0),y(!1)}o.useEffect(function(){const u=S.current.dataset.image,l=v.current.dataset.image;m&&N(u),x&&N(l)},[m,x,c]);const C=i+i/100*70;function q(){const l=(C-i)/600*100;return Math.ceil(l)}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 items-start justify-center gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-8 px-8 py-10",children:[e.jsx("div",{children:e.jsx("img",{src:P,alt:"book_image-front",className:"h-[32rem] w-[23rem] rounded-lg shadow-lg shadow-gray-400"})}),e.jsxs("div",{className:"flex items-center justify-center gap-8",children:[e.jsx("button",{"data-image":c,ref:S,onClick:z,className:`imageBtn ${m?"border-[#FF7733]":"border-gray-300"}`,children:e.jsx("img",{src:c,className:"h-full w-full rounded-sm",alt:"image_cover_front_button"})}),e.jsx("button",{"data-image":b,ref:v,onClick:R,className:`imageBtn ${x?"border-[#FF7733]":"border-gray-300"}`,children:e.jsx("img",{src:b,className:"h-full w-full rounded-sm",alt:"image_cover_back_button"})})]})]}),e.jsxs("div",{className:"flex flex-col items-start justify-center gap-8 px-8",children:[e.jsxs("div",{className:"flex flex-col items-start justify-start gap-8 px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col items-start justify-center gap-8 text-[2.5rem] font-bold text-gray-900",children:[e.jsx("h1",{children:a}),e.jsx("p",{className:"rounded-full bg-gray-100 px-4 py-2 text-center text-xl font-medium text-black shadow-inner",children:p}),e.jsxs("p",{className:"flex gap-4 text-base text-blue-950",children:[e.jsx(W,{size:20})," ",e.jsx("span",{children:"Your order will be delivered within the next 24 hours."})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8",children:[e.jsxs("p",{className:"text-[2.2rem] font-semibold text-gray-950",children:["₹",i,".00"]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("p",{className:"text-base font-medium text-gray-600",children:["M.R.P.:"," ",e.jsx("span",{className:"line-through",children:`${C}`})]}),e.jsx("p",{className:"text-2xl font-normal text-red-600",children:`-${q()}% Discount`})]})]}),e.jsx("div",{className:"flex items-center justify-center gap-8",children:e.jsx("button",{className:"flex items-center justify-center gap-4 rounded-full bg-[#ff5500] px-[6.5rem] py-3 text-[1.4rem] font-semibold text-white outline-none transition-all hover:bg-[#E64D00] active:bg-[#E64D00]",onClick:M,children:E?e.jsx(ee,{}):e.jsxs("span",{className:"flex items-center justify-center gap-4",children:[e.jsx(X,{size:35,className:"text-white"})," Add to Cart"]})})})]}),e.jsxs("div",{className:"bookTableMainStyle grid grid-cols-2 items-center justify-center gap-8 rounded-lg border-2 border-gray-300",children:[e.jsx("div",{className:"bookTableStyle",children:e.jsxs("p",{className:"bookDetailStyle",children:["Author:   ",e.jsx("br",{}),e.jsx("span",{className:"bookDataStyle",children:r})]})}),e.jsx("div",{className:"bookTableStyle",children:e.jsxs("p",{className:"bookDetailStyle",children:["Book Type:   ",e.jsx("br",{}),e.jsx("span",{className:`bookDataStyle ${n.replaceAll("-","").toLowerCase()==="selfhelp"&&"bg-green-800 text-white"} ${n.replaceAll("-","").toLowerCase()==="fiction"&&"bg-red-500 text-white"} ${n.replaceAll("-","").toLowerCase()==="nonfiction"&&"bg-gray-700 text-white"}`,children:n})]})}),e.jsx("div",{className:"bookTableStyle",children:e.jsxs("p",{className:"bookDetailStyle",children:["Theme:   ",e.jsx("br",{}),e.jsx("span",{className:"bookDataStyle",children:L})]})}),e.jsx("div",{className:"bookTableStyle",children:e.jsxs("p",{className:"bookDetailStyle",children:["First published:  ",e.jsx("br",{}),e.jsx("span",{className:"bookDataStyle",children:T})]})}),e.jsx("div",{className:"bookTableStyle",children:e.jsxs("p",{className:"bookDetailStyle",children:["Copies sold:  ",e.jsx("br",{}),e.jsx("span",{className:"bookDataStyle",children:w})]})}),e.jsx("div",{className:"bookTableStyle",children:e.jsxs("p",{className:"bookDetailStyle",children:["Latest edition:  ",e.jsx("br",{}),e.jsxs("span",{className:"bookDataStyle",children:[_," ",p]})]})})]})]})]}),e.jsx("div",{className:"px-4 py-8",children:e.jsxs("p",{className:"bookDetailStyle flex w-full flex-col items-start gap-2 rounded-sm bg-[#fdf6f3] px-8 text-2xl shadow-none",children:["Description of book: ",e.jsx("br",{}),e.jsxs("span",{className:"bookDataStyle bg-[#fdf6f3] text-justify text-xl leading-[2.25rem]",children:["            ",B]})]})})]})}function he(){const{handleOutsideClick:s}=G(),{isLoading:t,book:a,error:r}=ae();return t?e.jsx(H,{}):r?e.jsx(V,{error:r.message}):e.jsx("section",{className:"overflow-hidden px-[2rem] py-[1.4rem]",onClick:s,children:e.jsx(oe,{book:a})})}export{he as default};
